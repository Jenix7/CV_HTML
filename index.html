<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Portfolio Profesional</title>
	<link href="styles.css" rel="stylesheet" type="text/css">
</head>

<body>
	<div class="header-bar">
		<div class="header-content">
			<div class="section-title-header" id="sectionTitleHeader">Currículum</div>
			<div class="section-switch">
				<button class="switch-btn active" id="switchCV"
					onclick="switchSection('curriculum')">Currículum</button>
				<button class="switch-btn" id="switchPortfolio" onclick="switchSection('portfolio')">Portfolio</button>
			</div>
		</div>
	</div>

	<div class="container">
		<div class="section curriculum" id="curriculumSection">
			<div class="cv-container">
				<div class="cv-background">
					<div id="cv-tablon"><img src="images/Tablon.png" alt="Tablón"></div>
					<div id="cv-corcho"><img src="images/Corcho.png" alt="Corcho"></div>
					<div id="cv-circulo"><img src="images/Circulo.png" alt="Círculo"></div>
					<div id="cv-experiencia"><img src="images/Experiencia.png" alt="Experiencia"></div>
					<div id="cv-aptitudes"><img src="images/Aptitudes.png" alt="Aptitudes"></div>
					<div id="cv-resumen-personal"><img src="images/ResumenPersonal.png" alt="Resumen Personal"></div>
					<div id="cv-targeta-javier"><img src="images/TargetaJavier.png" alt="Tarjeta Javier"></div>
					<div id="cv-clip"><img src="images/Clip.png" alt="Clip"></div>
					<div id="cv-licenciado"><img src="images/Licenciado.png" alt="Licenciado"></div>
					<div id="cv-photoshop"><img src="images/Photosho.png" alt="Photoshop"></div>
					<div id="cv-zbrush"><img src="images/Zbrush.png" alt="ZBrush"></div>
					<div id="cv-opentoonz"><img src="images/OpenToonz.png" alt="OpenToonz"></div>
					<div id="cv-premiere"><img src="images/Premiere.png" alt="Premiere"></div>
					<div id="cv-after-effects"><img src="images/AfterEfects.png" alt="After Effects"></div>
					<div id="cv-unreal"><img src="images/Unreal.png" alt="Unreal"></div>
					<div id="cv-cascadeur"><img src="images/Cascadeur.png" alt="Cascadeur"></div>
					<div id="cv-marmoset"><img src="images/Marmoset.png" alt="Marmoset"></div>
					<div id="cv-substance"><img src="images/Substance.png" alt="Substance"></div>
					<div id="cv-3dmax"><img src="images/3DMax.png" alt="3D Max"></div>
					<div id="cv-maya"><img src="images/Maya.png" alt="Maya"></div>
					<div id="cv-blender"><img src="images/Blender.png" alt="Blender"></div>
					<div id="cv-unity"><img src="images/Unity.png" alt="Unity"></div>
					<div id="cv-illustrator"><img src="images/Ilustator.png" alt="Illustrator"></div>
					<div id="cv-entrada2"><img src="images/Entrada2.png" alt="Entrada 2"></div>
					<div id="cv-entrada1"><img src="images/Entrada1.png" alt="Entrada 1"></div>
					<div id="cv-cinta-video2"><img src="images/CintaVideo2.png" alt="Cinta Video 2"></div>
					<div id="cv-cinta-video1"><img src="images/CintaVideo1.png" alt="Cinta Video 1"></div>
					<div id="cv-consola"><img src="images/Consola.png" alt="Consola"></div>
					<div id="cv-artilugio"><img src="images/Artilugio.png" alt="Artilugio"></div>
					<div id="cv-coral"><img src="images/Coral.png" alt="Coral"></div>
					<div id="cv-sydan"><img src="images/Sydan.png" alt="Sydan"></div>
					<div id="cv-porky"><img src="images/Porky.png" alt="Porky"></div>
					<div id="cv-zapato"><img src="images/Zapato.png" alt="Zapato"></div>
					<div id="cv-sobre"><img src="images/Sobre.png" alt="Sobre"></div>
					<div id="cv-chincheta-verde"><img src="images/Chinchetaverde.png" alt="Chincheta Verde"></div>
					<div id="cv-videojuegos"><img src="images/Videojuegos.png" alt="Videojuegos"></div>
					<div id="cv-ilustracion"><img src="images/Ilustracin.png" alt="Ilustración"></div>
					<div id="cv-webs"><img src="images/Webs.png" alt="Webs"></div>
					<div id="cv-modelado3d"><img src="images/Modelado3D.png" alt="Modelado 3D"></div>
					<div id="cv-diseno-grafico"><img src="images/Diseogrfico.png" alt="Diseño Gráfico"></div>
					<div id="cv-edicion"><img src="images/Edicin.png" alt="Edición"></div>
					<div id="cv-portfolio-titulo"><img src="images/Portfoliotitulo.png" alt="Portfolio Título"></div>
				</div>
			</div>
		</div>

		<div class="section portfolio" id="portfolioSection">
			<div class="portfolio-content">
				<div class="cards-container" id="cardsContainer">
					<div class="card-wrapper" data-category="todo">
						<div class="card-title">TODO</div>
						<div class="portfolio-card" data-category="todo">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/TargetaJavier_High.png" alt="TODO">
								</div>
								<div class="card-back">
									<img src="images/TargetaJavier_High_Back.png" alt="TODO Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Todo.png" alt="TODO subtitle">
						</div>
					</div>

					<div class="card-wrapper" data-category="arte">
						<div class="card-title">ARTE</div>
						<div class="portfolio-card" data-category="arte">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/Targeta_Artista.png" alt="ARTE">
								</div>
								<div class="card-back">
									<img src="images/Targeta_Artista_Back.png" alt="ARTE Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Arte.png" alt="ARTE subtitle">
						</div>
					</div>

					<div class="card-wrapper" data-category="programacion">
						<div class="card-title">PROGRAMACIÓN</div>
						<div class="portfolio-card" data-category="programacion">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/Targeta_Programador.png" alt="PROGRAMACIÓN">
								</div>
								<div class="card-back">
									<img src="images/Targeta_Programador_Back.png" alt="PROGRAMACIÓN Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Programacion.png" alt="PROGRAMACIÓN subtitle">
						</div>
					</div>

					<div class="card-wrapper" data-category="diseño">
						<div class="card-title">DISEÑO</div>
						<div class="portfolio-card" data-category="diseño">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/Targeta_Diseñador.png" alt="DISEÑO">
								</div>
								<div class="card-back">
									<img src="images/Targeta_Diseñador_Back.png" alt="DISEÑO Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Diseño.png" alt="DISEÑO subtitle">
						</div>
					</div>

					<div class="card-wrapper" data-category="produccion">
						<div class="card-title">PRODUCCIÓN</div>
						<div class="portfolio-card" data-category="produccion">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/Targeta_Productor.png" alt="PRODUCCIÓN">
								</div>
								<div class="card-back">
									<img src="images/Targeta_Productor_Back.png" alt="PRODUCCIÓN Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Produccion.png" alt="PRODUCCIÓN subtitle">
						</div>
					</div>

					<div class="card-wrapper" data-category="comunicacion">
						<div class="card-title">COMUNICACIÓN</div>
						<div class="portfolio-card" data-category="comunicacion">
							<div class="card-inner">
								<div class="card-front">
									<img src="images/Targeta_Comunicador.png" alt="COMUNICACIÓN">
								</div>
								<div class="card-back">
									<img src="images/Targeta_Comunicador_Back.png" alt="COMUNICACIÓN Back">
								</div>
							</div>
						</div>
						<div class="card-subtitle">
							<img src="images/Sub_Comunicacion.png" alt="COMUNICACIÓN subtitle">
						</div>
					</div>
				</div>

				<div class="content-area" id="contentArea" style="display: none;">
				</div>

				<div class="categories-container" id="categoriesContainer" style="display: none;">
				</div>
			</div>
		</div>
	</div>

	<div id="imageModal" class="modal">
		<div class="modal-overlay"></div>
		<div class="modal-content">
			<button class="modal-close" id="modalClose">&times;</button>
			<img id="modalImage" src="" alt="">
		</div>
	</div>

	<div class="custom-tooltip" id="customTooltip">
		<span class="tooltip-text"></span>
	</div>

	<script>
		let currentSection = 'curriculum';
		let currentCategory = 'todo';
		let currentTheme = '';
		let animationComplete = false;
		let portfolioAnimated = false;
		let selectedCard = null;
		let categoryDetailView = false;
		let currentCategoryIndex = null;

		const tooltip = document.getElementById('customTooltip');
		const tooltipText = tooltip.querySelector('.tooltip-text');
		let tooltipTimeout = null;

		const categoryColors = {
			'todo': 'green',
			'arte': 'red',
			'programacion': 'blue',
			'diseño': 'yellow',
			'produccion': 'purple',
			'comunicacion': 'pink'
		};

		let portfolioData = {
			'arte': { name: 'ARTE', categories: [] },
			'programacion': { name: 'PROGRAMACIÓN', categories: [] },
			'diseño': { name: 'DISEÑO', categories: [] },
			'produccion': { name: 'PRODUCCIÓN', categories: [] },
			'comunicacion': { name: 'COMUNICACIÓN', categories: [] },
			'todo': { name: 'TODO', categories: [] }
		};

		async function loadPortfolioData() {
			console.log('Loading portfolio data from JSON...');

			try {
				const response = await fetch('portfolio-data.json');
				if (!response.ok) {
					throw new Error(`HTTP error! status: ${response.status}`);
				}
				portfolioData = await response.json();
				console.log('✅ Portfolio data loaded successfully:', portfolioData);

				for (const [key, data] of Object.entries(portfolioData)) {
					if (key !== 'todo') {
						const totalImages = data.categories.reduce((sum, cat) => sum + cat.images.length, 0);
						console.log(`  • ${data.name}: ${data.categories.length} categorías, ${totalImages} imágenes`);
					}
				}

				preloadAllImages();
			} catch (error) {
				console.error('❌ Error loading portfolio data:', error);
				console.error('⚠️ Asegúrate de que existe el archivo portfolio-data.json');
				console.error('⚠️ Ejecuta el script generate_portfolio.py primero');
			}
		}

		function preloadAllImages() {
			console.log('🖼️ Precargando imágenes del portfolio...');
			let totalImages = 0;
			let loadedImages = 0;

			for (const [key, data] of Object.entries(portfolioData)) {
				if (key === 'todo' || !data.categories) continue;

				data.categories.forEach(category => {
					category.images.forEach(imageSrc => {
						totalImages++;
						const img = new Image();
						img.onload = () => {
							loadedImages++;
							if (loadedImages === totalImages) {
								console.log(`✅ Todas las imágenes precargadas (${totalImages})`);
							}
						};
						img.onerror = () => {
							console.warn(`⚠️ Error cargando: ${imageSrc}`);
							loadedImages++;
						};
						img.src = imageSrc;
					});
				});
			}

			console.log(`📊 Precargando ${totalImages} imágenes en segundo plano...`);
		}

		const elementNames = {
			'cv-targeta-javier': { name: 'Tarjeta Personal', icon: '👤', clickable: true },
			'cv-resumen-personal': { name: 'Resumen Personal', icon: '📄', clickable: true },
			'cv-experiencia': { name: 'Experiencia', icon: '💼', clickable: true },
			'cv-aptitudes': { name: 'Aptitudes', icon: '⭐', clickable: true },
			'cv-licenciado': { name: 'Título Universitario', icon: '🎓', clickable: true },
			'cv-photoshop': { name: 'Photoshop', icon: '🎨', clickable: false },
			'cv-zbrush': { name: 'ZBrush', icon: '🗿', clickable: false },
			'cv-opentoonz': { name: 'OpenToonz', icon: '🎬', clickable: false },
			'cv-premiere': { name: 'Premiere', icon: '🎞️', clickable: false },
			'cv-after-effects': { name: 'After Effects', icon: '✨', clickable: false },
			'cv-unreal': { name: 'Unreal Engine', icon: '🎮', clickable: false },
			'cv-cascadeur': { name: 'Cascadeur', icon: '🤸', clickable: false },
			'cv-marmoset': { name: 'Marmoset', icon: '🦊', clickable: false },
			'cv-substance': { name: 'Substance', icon: '🧪', clickable: false },
			'cv-3dmax': { name: '3D Max', icon: '📦', clickable: false },
			'cv-maya': { name: 'Maya', icon: '🛕', clickable: false },
			'cv-blender': { name: 'Blender', icon: '🌀', clickable: false },
			'cv-unity': { name: 'Unity', icon: '🎯', clickable: false },
			'cv-illustrator': { name: 'Illustrator', icon: '✏️', clickable: false },
			'cv-portfolio-titulo': { name: 'Portfolio', icon: '📂', clickable: false },
			'cv-entrada1': { name: 'Diseño Gráfico', icon: '🎨', clickable: false },
			'cv-entrada2': { name: 'Diseño Gráfico', icon: '🎨', clickable: false },
			'cv-diseno-grafico': { name: 'Diseño Gráfico', icon: '🎨', clickable: false },
			'cv-coral': { name: 'Modelado 3D', icon: '🪸', clickable: false },
			'cv-zapato': { name: 'Modelado 3D', icon: '👟', clickable: false },
			'cv-modelado3d': { name: 'Modelado 3D', icon: '📦', clickable: false },
			'cv-porky': { name: 'Ilustración', icon: '🐷', clickable: false },
			'cv-sydan': { name: 'Ilustración', icon: '🦌', clickable: false },
			'cv-ilustracion': { name: 'Ilustración', icon: '🖼️', clickable: false },
			'cv-cinta-video1': { name: 'Edición de Video', icon: '📹', clickable: false },
			'cv-cinta-video2': { name: 'Edición de Video', icon: '📹', clickable: false },
			'cv-edicion': { name: 'Edición', icon: '✂️', clickable: false },
			'cv-artilugio': { name: 'Webs', icon: '🌐', clickable: false },
			'cv-webs': { name: 'Desarrollo Web', icon: '💻', clickable: false },
			'cv-consola': { name: 'Videojuegos', icon: '🎮', clickable: false },
			'cv-videojuegos': { name: 'Videojuegos', icon: '🕹️', clickable: false }
		};

		function showTooltip(element, x, y) {
			const data = elementNames[element.id];
			if (!data) return;

			clearTimeout(tooltipTimeout);

			tooltipTimeout = setTimeout(() => {
				tooltipText.textContent = data.name;

				tooltip.classList.remove('clickable');

				tooltip.style.left = x + 'px';
				tooltip.style.top = y + 'px';
				tooltip.classList.add('show');
			}, 500);
		}

		function hideTooltip() {
			clearTimeout(tooltipTimeout);
			tooltip.classList.remove('show');
		}

		function updateTooltipPosition(x, y) {
			tooltip.style.left = x + 'px';
			tooltip.style.top = y + 'px';
		}

		window.addEventListener('load', () => {
			loadPortfolioData().then(() => {
				console.log('Portfolio data ready');
			});

			const cvElements = document.querySelectorAll('.cv-background > div');

			cvElements.forEach(element => {
				element.style.pointerEvents = 'none';
			});

			const tablonGroupElements = [
				'cv-tablon',
				'cv-sobre'
			];

			const compactGroupElements = [
				'cv-webs',
				'cv-artilugio',
				'cv-coral',
				'cv-zapato',
				'cv-modelado3d',
				'cv-edicion',
				'cv-cinta-video1',
				'cv-cinta-video2',
				'cv-ilustracion',
				'cv-porky',
				'cv-sydan',
				'cv-diseno-grafico',
				'cv-entrada1',
				'cv-entrada2',
				'cv-videojuegos',
				'cv-consola',
				'cv-chincheta-verde',
				'cv-portfolio-titulo'
			];

			const smallIconElements = [
				'cv-photoshop',
				'cv-unity',
				'cv-premiere',
				'cv-3dmax',
				'cv-blender',
				'cv-maya',
				'cv-illustrator',
				'cv-substance',
				'cv-unreal',
				'cv-zbrush',
				'cv-cascadeur',
				'cv-marmoset',
				'cv-after-effects',
				'cv-opentoonz'
			];

			const directions = [
				{ x: '-200vw', y: '0', rotate: '-180deg' },
				{ x: '200vw', y: '0', rotate: '180deg' },
				{ x: '0', y: '-200vh', rotate: '-360deg' },
				{ x: '0', y: '200vh', rotate: '360deg' },
				{ x: '-150vw', y: '-150vh', rotate: '-270deg' },
				{ x: '150vw', y: '-150vh', rotate: '270deg' },
				{ x: '-150vw', y: '150vh', rotate: '-90deg' },
				{ x: '150vw', y: '150vh', rotate: '90deg' }
			];

			const tablonGroupDirection = directions[Math.floor(Math.random() * directions.length)];
			const groupDirection = directions[Math.floor(Math.random() * directions.length)];

			let maxDelay = 0;
			let animationsCount = 0;
			let completedAnimations = 0;

			cvElements.forEach((element, index) => {
				if (tablonGroupElements.includes(element.id)) {
					element.style.setProperty('--start-x', tablonGroupDirection.x);
					element.style.setProperty('--start-y', tablonGroupDirection.y);
					element.style.setProperty('--start-rotate', tablonGroupDirection.rotate);

					animationsCount++;
					const delay = 0;
					maxDelay = Math.max(maxDelay, delay + 850);

					setTimeout(() => {
						element.classList.add('animate-in');

						setTimeout(() => {
							element.classList.remove('animate-in');
							element.classList.add('animation-complete');
							element.style.animation = '';
							element.style.transform = '';
							element.style.removeProperty('--start-x');
							element.style.removeProperty('--start-y');
							element.style.removeProperty('--start-rotate');
							completedAnimations++;
							checkAllAnimationsComplete();
						}, 850);
					}, delay);
				}
				else if (compactGroupElements.includes(element.id)) {
					element.style.setProperty('--start-x', groupDirection.x);
					element.style.setProperty('--start-y', groupDirection.y);
					element.style.setProperty('--start-rotate', groupDirection.rotate);

					animationsCount++;
					const delay = 600;
					maxDelay = Math.max(maxDelay, delay + 850);

					setTimeout(() => {
						element.classList.add('animate-in');

						setTimeout(() => {
							element.classList.remove('animate-in');
							element.classList.add('animation-complete');
							element.style.animation = '';
							element.style.transform = '';
							element.style.removeProperty('--start-x');
							element.style.removeProperty('--start-y');
							element.style.removeProperty('--start-rotate');
							completedAnimations++;
							checkAllAnimationsComplete();
						}, 850);
					}, delay);
				}
				else if (smallIconElements.includes(element.id)) {
					const randomDirection = directions[Math.floor(Math.random() * directions.length)];

					element.style.setProperty('--start-x', randomDirection.x);
					element.style.setProperty('--start-y', randomDirection.y);
					element.style.setProperty('--start-rotate', randomDirection.rotate);

					animationsCount++;
					const delay = index * 50;
					maxDelay = Math.max(maxDelay, delay + 850);

					setTimeout(() => {
						element.classList.add('animate-in-subtle');

						setTimeout(() => {
							element.classList.remove('animate-in-subtle');
							element.classList.add('animation-complete');
							element.style.animation = '';
							element.style.transform = '';
							element.style.removeProperty('--start-x');
							element.style.removeProperty('--start-y');
							element.style.removeProperty('--start-rotate');
							completedAnimations++;
							checkAllAnimationsComplete();
						}, 850);
					}, delay);
				} else {
					const randomDirection = directions[Math.floor(Math.random() * directions.length)];

					element.style.setProperty('--start-x', randomDirection.x);
					element.style.setProperty('--start-y', randomDirection.y);
					element.style.setProperty('--start-rotate', randomDirection.rotate);

					animationsCount++;
					const delay = index * 50;
					maxDelay = Math.max(maxDelay, delay + 850);

					setTimeout(() => {
						element.classList.add('animate-in');

						setTimeout(() => {
							element.classList.remove('animate-in');
							element.classList.add('animation-complete');
							element.style.animation = '';
							element.style.transform = '';
							element.style.removeProperty('--start-x');
							element.style.removeProperty('--start-y');
							element.style.removeProperty('--start-rotate');
							completedAnimations++;
							checkAllAnimationsComplete();
						}, 850);
					}, delay);
				}
			});

			function checkAllAnimationsComplete() {
				if (completedAnimations === animationsCount && !animationComplete) {
					animationComplete = true;
					cvElements.forEach(element => {
						if (element.id !== 'cv-sobre') {
							element.style.pointerEvents = 'auto';
						}
					});

					const cvContainer = document.querySelector('.cv-container');
					cvContainer.style.overflow = 'hidden';
				}
			}
		});

		const hoverGroups = {
			group1: ['cv-entrada2', 'cv-entrada1', 'cv-diseno-grafico'],
			group2: ['cv-coral', 'cv-zapato', 'cv-modelado3d'],
			group3: ['cv-porky', 'cv-sydan', 'cv-ilustracion'],
			group4: ['cv-cinta-video2', 'cv-cinta-video1', 'cv-edicion'],
			group5: ['cv-artilugio', 'cv-webs'],
			group6: ['cv-consola', 'cv-videojuegos']
		};

		Object.values(hoverGroups).forEach(group => {
			group.forEach(elementId => {
				const element = document.getElementById(elementId);
				if (element) {
					element.addEventListener('mouseenter', (e) => {
						showTooltip(element, e.clientX, e.clientY);
						group.forEach(id => {
							const el = document.getElementById(id);
							if (el) {
								el.style.transform = 'scale(1.05) translateY(-2px)';
								el.style.zIndex = '999';
								el.style.filter = 'drop-shadow(0 0 3px rgba(74, 222, 128, 0.9)) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3)) brightness(1.12) contrast(1.05) saturate(1.15)';
								el.style.animation = 'pulse-glow 1.5s ease-in-out infinite';
							}
						});
					});

					element.addEventListener('mousemove', (e) => {
						updateTooltipPosition(e.clientX, e.clientY);
					});

					element.addEventListener('mouseleave', () => {
						hideTooltip();
						group.forEach(id => {
							const el = document.getElementById(id);
							if (el) {
								el.style.transform = '';
								el.style.zIndex = '';
								el.style.filter = '';
								el.style.animation = '';
							}
						});
					});
				}
			});
		});

		const modal = document.getElementById('imageModal');
		const modalImage = document.getElementById('modalImage');
		const modalClose = document.getElementById('modalClose');
		const modalOverlay = document.querySelector('.modal-overlay');

		const highResMap = {
			'cv-targeta-javier': 'images/TargetaJavier_High.png',
			'cv-resumen-personal': 'images/ResumenPersonal_High.png',
			'cv-experiencia': 'images/Experiencia_High.png',
			'cv-aptitudes': 'images/Aptitudes_High.png',
			'cv-licenciado': 'images/Licenciado_High.png'
		};

		const clickableElements = [
			'cv-targeta-javier',
			'cv-resumen-personal',
			'cv-experiencia',
			'cv-aptitudes',
			'cv-licenciado'
		];

		clickableElements.forEach(elementId => {
			const element = document.getElementById(elementId);
			if (element) {
				element.addEventListener('mouseenter', (e) => {
					showTooltip(element, e.clientX, e.clientY);
				});

				element.addEventListener('mousemove', (e) => {
					updateTooltipPosition(e.clientX, e.clientY);
				});

				element.addEventListener('mouseleave', () => {
					hideTooltip();
				});

				element.addEventListener('click', () => {
					hideTooltip();
					const highResImage = highResMap[elementId];
					if (highResImage) {
						modalImage.src = highResImage;

						if (elementId === 'cv-licenciado') {
							modalImage.setAttribute('data-no-card-effect', 'true');
						} else {
							modalImage.removeAttribute('data-no-card-effect');
						}
					} else {
						const img = element.querySelector('img');
						if (img) {
							modalImage.src = img.src;
							modalImage.removeAttribute('data-no-card-effect');
						}
					}
					modal.classList.add('active');
					document.body.style.overflow = 'hidden';
				});
			}
		});

		const individualHoverElements = [
			'cv-photoshop', 'cv-zbrush', 'cv-opentoonz', 'cv-premiere',
			'cv-after-effects', 'cv-unreal', 'cv-cascadeur', 'cv-marmoset',
			'cv-substance', 'cv-3dmax', 'cv-maya', 'cv-blender', 'cv-unity',
			'cv-illustrator', 'cv-portfolio-titulo'
		];

		individualHoverElements.forEach(elementId => {
			const element = document.getElementById(elementId);
			if (element) {
				element.addEventListener('mouseenter', (e) => {
					showTooltip(element, e.clientX, e.clientY);
				});

				element.addEventListener('mousemove', (e) => {
					updateTooltipPosition(e.clientX, e.clientY);
				});

				element.addEventListener('mouseleave', () => {
					hideTooltip();
				});
			}
		});

		modalOverlay.addEventListener('click', closeModal);

		modalClose.addEventListener('click', closeModal);

		document.addEventListener('keydown', (e) => {
			if (e.key === 'Escape' && modal.classList.contains('active')) {
				closeModal();
			}
		});

		function closeModal() {
			modal.classList.remove('active');
			document.body.style.overflow = '';
			setTimeout(() => {
				modalImage.src = '';
			}, 300);
		}

		modalImage.addEventListener('mousemove', (e) => {
			if (modalImage.hasAttribute('data-no-card-effect')) {
				return;
			}

			const rect = modalImage.getBoundingClientRect();
			const x = e.clientX - rect.left;
			const y = e.clientY - rect.top;

			const centerX = rect.width / 2;
			const centerY = rect.height / 2;

			const rotateX = ((y - centerY) / centerY) * -10;
			const rotateY = ((x - centerX) / centerX) * 10;

			modalImage.style.transition = 'transform 0.15s ease-out';
			modalImage.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
		});

		modalImage.addEventListener('mouseenter', () => {
			if (modalImage.hasAttribute('data-no-card-effect')) {
				return;
			}
			modalImage.style.transition = 'transform 0.6s ease-out';
		});

		modalImage.addEventListener('mouseleave', () => {
			if (modalImage.hasAttribute('data-no-card-effect')) {
				return;
			}
			modalImage.style.transition = 'transform 0.6s ease-out';
			modalImage.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)';
		});

		const contentData = {
			todo: {
				title: '',
				content: ''
			},
			arte: {
				title: '',
				content: ''
			},
			diseño: {
				title: '',
				content: ''
			},
			programacion: {
				title: '',
				content: ''
			},
			produccion: {
				title: '',
				content: ''
			},
			comunicacion: {
				title: '',
				content: ''
			}
		};

		function switchSection(section) {
			const curriculumSection = document.getElementById('curriculumSection');
			const portfolioSection = document.getElementById('portfolioSection');
			const sectionTitleHeader = document.getElementById('sectionTitleHeader');
			const switchCV = document.getElementById('switchCV');
			const switchPortfolio = document.getElementById('switchPortfolio');

			if (section === 'portfolio') {
				curriculumSection.classList.add('slide-left');
				portfolioSection.classList.add('slide-left');

				if (currentCategory && portfolioData[currentCategory]) {
					sectionTitleHeader.textContent = portfolioData[currentCategory].name;
				} else {
					sectionTitleHeader.textContent = 'Portfolio';
				}

				switchCV.classList.remove('active');
				switchPortfolio.classList.add('active');
				currentSection = 'portfolio';

				if (currentTheme) {
					document.body.className = currentTheme;
				}

				if (!portfolioAnimated) {
					setTimeout(() => {
						animatePortfolioCards();
						portfolioAnimated = true;
					}, 200);
				}
			} else {
				curriculumSection.classList.remove('slide-left');
				portfolioSection.classList.remove('slide-left');
				sectionTitleHeader.textContent = 'Currículum';
				switchCV.classList.add('active');
				switchPortfolio.classList.remove('active');
				currentSection = 'curriculum';

				document.body.className = '';
			}
		}

		function animatePortfolioCards() {
			const cards = document.querySelectorAll('.card-wrapper');
			cards.forEach((card, index) => {
				setTimeout(() => {
					card.classList.add('animate-in');
				}, index * 100);
			});

			setTimeout(() => {
				createPlaceholders();

				const portfolioCards = document.querySelectorAll('.portfolio-card');
				portfolioCards.forEach(card => {
					card.addEventListener('click', handleCardClick);

					const cardInner = card.querySelector('.card-inner');
					cardInner.addEventListener('mousemove', handleCardHover);
					cardInner.addEventListener('mouseleave', handleCardLeave);
					cardInner.addEventListener('mouseenter', handleCardEnter);
				});

				const categoriesContainer = document.getElementById('categoriesContainer');
				categoriesContainer.addEventListener('click', handleCategoryClick);
			}, 800);
		}

		const cardOrder = ['todo', 'arte', 'programacion', 'diseño', 'produccion', 'comunicacion'];

		function calculateMenuPosition(index) {
			const startLeft = 0;
			const cardHeight = 280;
			const gap = 15;
			const scale = 1.2;
			const scaledHeight = cardHeight * scale;
			const scaledGap = gap * scale;

			return {
				left: startLeft + (index * (scaledHeight + scaledGap)),
				top: 80
			};
		}

		function createPlaceholders() {
			const cardsContainer = document.getElementById('cardsContainer');

			cardOrder.forEach((category, index) => {
				const pos = calculateMenuPosition(index);

				const originalCard = document.querySelector(`.card-wrapper[data-category="${category}"]`);
				const backImage = originalCard.querySelector('.card-back img');
				const subtitleImage = originalCard.querySelector('.card-subtitle img');

				const placeholder = document.createElement('div');
				placeholder.className = 'card-placeholder';
				placeholder.dataset.category = category;
				placeholder.style.position = 'fixed';
				placeholder.style.left = pos.left + 'px';
				placeholder.style.top = pos.top + 'px';
				placeholder.style.width = '187px';
				placeholder.style.height = '280px';
				placeholder.style.transform = 'scale(1.2) rotateZ(90deg)';
				placeholder.style.transformOrigin = 'center center';
				placeholder.style.zIndex = '800';
				placeholder.style.opacity = '0';
				placeholder.style.transition = 'opacity 0.3s ease';
				placeholder.style.pointerEvents = 'none';
				placeholder.style.overflow = 'visible';

				const cardContainer = document.createElement('div');
				cardContainer.style.position = 'relative';
				cardContainer.style.width = '100%';
				cardContainer.style.height = '100%';
				cardContainer.style.borderRadius = '16px';
				cardContainer.style.border = '2px solid rgba(255, 255, 255, 0.1)';
				cardContainer.style.overflow = 'hidden';

				if (backImage) {
					const img = document.createElement('img');
					img.src = backImage.src;
					img.style.width = '100%';
					img.style.height = '100%';
					img.style.objectFit = 'cover';
					img.style.opacity = '0.3';
					cardContainer.appendChild(img);
				}

				placeholder.appendChild(cardContainer);

				if (subtitleImage) {
					const subtitleDiv = document.createElement('div');
					subtitleDiv.className = 'placeholder-subtitle';
					subtitleDiv.style.opacity = '0.3';
					subtitleDiv.style.width = '280px';
					subtitleDiv.style.height = '1307px';
					subtitleDiv.style.position = 'absolute';
					subtitleDiv.style.left = '50%';
					subtitleDiv.style.top = '50%';
					subtitleDiv.style.transform = 'translate(-50%, -50%) translateX(-750px) rotateZ(90deg)';
					subtitleDiv.style.transformOrigin = 'center center';
					subtitleDiv.style.pointerEvents = 'none';

					const subImg = document.createElement('img');
					subImg.src = subtitleImage.src;
					subImg.style.width = '100%';
					subImg.style.height = 'auto';
					subImg.style.display = 'block';

					subtitleDiv.appendChild(subImg);
					placeholder.appendChild(subtitleDiv);
				}

				cardsContainer.appendChild(placeholder);
			});
		}

		function updateCardPositions() {
			cardOrder.forEach((category, index) => {
				const wrapper = document.querySelector(`.card-wrapper[data-category="${category}"]`);
				const placeholder = document.querySelector(`.card-placeholder[data-category="${category}"]`);

				if (!wrapper) return;

				const pos = calculateMenuPosition(index);

				if (wrapper.classList.contains('featured')) {
					wrapper.style.position = 'fixed';
					wrapper.style.left = '24px';
					wrapper.style.top = '100px';
					wrapper.style.zIndex = '1000';

					if (placeholder) {
						placeholder.style.opacity = '1';
					}
				} else {
					wrapper.classList.add('in-menu');
					wrapper.style.position = 'fixed';
					wrapper.style.left = pos.left + 'px';
					wrapper.style.top = pos.top + 'px';
					wrapper.style.zIndex = '900';

					if (placeholder) {
						placeholder.style.opacity = '0';
					}
				}
			});
		}

		function renderCategories(sectionKey) {
			const categoriesContainer = document.getElementById('categoriesContainer');
			const sectionData = portfolioData[sectionKey];

			if (!sectionData || sectionData.categories.length === 0) {
				categoriesContainer.style.display = 'none';
				return;
			}

			categoriesContainer.innerHTML = '';

			let maxImagesInAnyCategory = 0;
			sectionData.categories.forEach(cat => {
				if (cat.images.length > maxImagesInAnyCategory) {
					maxImagesInAnyCategory = cat.images.length;
				}
			});

			const numColumns = sectionData.categories.length;
			let useOneColumn = false;

			if (maxImagesInAnyCategory === 1) {
				useOneColumn = true;
			} else if (maxImagesInAnyCategory === 2) {
				if (numColumns >= 4) {
					useOneColumn = true;
				}
			}

			const containerWidth = 1200;
			const columnWidth = containerWidth / numColumns;
			const imageWidth = useOneColumn ? columnWidth : (columnWidth / 2);
			const useThumb = imageWidth < 200;

			sectionData.categories.forEach((categoryData, index) => {
				const categoryColumn = document.createElement('div');
				categoryColumn.className = 'category-column';
				categoryColumn.style.setProperty('--num-columns', numColumns);
				categoryColumn.style.setProperty('--max-images', maxImagesInAnyCategory);
				categoryColumn.dataset.categoryIndex = index;

				const categoryTitle = document.createElement('div');
				categoryTitle.className = 'category-column-title';
				categoryTitle.textContent = categoryData.title;

				const imagesGrid = document.createElement('div');
				imagesGrid.className = 'category-images-grid';

				if (useOneColumn) {
					imagesGrid.style.gridTemplateColumns = '1fr';
				}

				categoryData.images.forEach(imageData => {
					const imageWrapper = document.createElement('div');
					imageWrapper.className = 'category-image-wrapper';

					const img = document.createElement('img');

					if (typeof imageData === 'object' && imageData.src) {
						const srcEncoded = imageData.src.replace(/ /g, '%20');
						const thumbEncoded = imageData.thumb ? imageData.thumb.replace(/ /g, '%20') : null;

						img.src = (useThumb && thumbEncoded) ? thumbEncoded : srcEncoded;
					} else {
						img.src = imageData;
					}

					img.alt = categoryData.title;

					imageWrapper.appendChild(img);
					imagesGrid.appendChild(imageWrapper);
				});

				categoryColumn.appendChild(categoryTitle);
				categoryColumn.appendChild(imagesGrid);
				categoriesContainer.appendChild(categoryColumn);

				setTimeout(() => {
					categoryColumn.classList.add('show');
				}, index * 100);
			});

			categoriesContainer.style.display = 'flex';
		}

		function handleCategoryClick(e) {
			const categoryColumn = e.target.closest('.category-column');
			if (!categoryColumn) return;

			const categoryIndex = parseInt(categoryColumn.dataset.categoryIndex);
			console.log('Clicked category:', categoryIndex);

			openCategoryDetail(categoryIndex);
		}

		function openCategoryDetail(categoryIndex) {
			const categoriesContainer = document.getElementById('categoriesContainer');

			if (categoryDetailView && currentCategoryIndex !== null) {
				// Cambio directo entre categorías (sin animación)
				currentCategoryIndex = categoryIndex;
				renderCategoryDetail(categoryIndex);
				return;
			}

			// Primera vez entrando a Vista 3 (con animación)
			categoryDetailView = true;
			currentCategoryIndex = categoryIndex;

			const cardsContainer = document.getElementById('cardsContainer');

			// Ocultar cartas y placeholders sin animación
			const allCardWrappers = document.querySelectorAll('.card-wrapper');
			allCardWrappers.forEach(wrapper => {
				if (!wrapper.classList.contains('featured')) {
					wrapper.style.transition = 'none';
					wrapper.style.opacity = '0';
					wrapper.style.pointerEvents = 'none';
				}
			});

			const allPlaceholders = document.querySelectorAll('.card-placeholder');
			allPlaceholders.forEach(placeholder => {
				placeholder.style.transition = 'none';
				placeholder.style.opacity = '0';
			});

			// Expandir y animar la entrada
			categoriesContainer.classList.add('expanded');
			categoriesContainer.style.opacity = '0';

			// Renderizar contenido
			renderCategoryDetail(categoryIndex);

			// Animar entrada con un pequeño delay
			requestAnimationFrame(() => {
				requestAnimationFrame(() => {
					categoriesContainer.style.transition = 'opacity 0.4s ease-out';
					categoriesContainer.style.opacity = '1';
				});
			});
		}

		function closeCategoryDetail() {
			categoryDetailView = false;
			currentCategoryIndex = null;

			const cardsContainer = document.getElementById('cardsContainer');
			const categoriesContainer = document.getElementById('categoriesContainer');

			// Cerrar directamente sin animación
			categoriesContainer.classList.remove('expanded');

			renderCategories(currentCategory);

			// Restaurar cartas directamente en sus posiciones finales
			const allCardWrappers = document.querySelectorAll('.card-wrapper');
			allCardWrappers.forEach(wrapper => {
				if (!wrapper.classList.contains('featured')) {
					wrapper.style.transition = 'none';
					wrapper.style.opacity = '1';
					wrapper.style.pointerEvents = 'auto';
					wrapper.style.transform = wrapper.classList.contains('in-menu') ?
						'scale(1.2) rotateZ(90deg)' : 'translateY(0)';
				}
			});

			const allPlaceholders = document.querySelectorAll('.card-placeholder');
			allPlaceholders.forEach(placeholder => {
				const wrapper = document.querySelector(`.card-wrapper[data-category="${placeholder.dataset.category}"]`);
				if (wrapper && wrapper.classList.contains('featured')) {
					placeholder.style.transition = 'none';
					placeholder.style.opacity = '1';
					placeholder.style.transform = 'scale(1.2) rotateZ(90deg)';
				}
			});
		}

		function renderCategoryDetail(categoryIndex) {
			const categoriesContainer = document.getElementById('categoriesContainer');
			const sectionData = portfolioData[currentCategory];

			if (!sectionData || !sectionData.categories[categoryIndex]) {
				console.error('Category not found');
				return;
			}

			const categoryData = sectionData.categories[categoryIndex];
			const isFirstRender = !categoriesContainer.querySelector('.category-detail-header');

			categoriesContainer.innerHTML = '';

			const detailHeader = document.createElement('div');
			detailHeader.className = 'category-detail-header';

			const backButton = document.createElement('button');
			backButton.className = 'back-button';
			backButton.style.display = 'flex';
			backButton.innerHTML = '← Atrás';
			backButton.onclick = closeCategoryDetail;

			const divider = document.createElement('div');
			divider.className = 'category-detail-header-divider';

			const categoryNav = document.createElement('div');
			categoryNav.className = 'category-navigation';
			categoryNav.style.display = 'flex';

			sectionData.categories.forEach((cat, idx) => {
				const navBtn = document.createElement('button');
				navBtn.className = 'category-nav-btn';
				if (idx === categoryIndex) {
					navBtn.classList.add('active');
				}
				navBtn.textContent = cat.title;
				navBtn.onclick = () => {
					if (idx !== categoryIndex) {
						openCategoryDetail(idx);
					}
				};
				categoryNav.appendChild(navBtn);
			});

			detailHeader.appendChild(backButton);
			detailHeader.appendChild(divider);
			detailHeader.appendChild(categoryNav);

			const detailGrid = document.createElement('div');
			detailGrid.className = 'category-detail-grid';

			categoryData.images.forEach((imageData, imgIndex) => {
				const imageContainer = document.createElement('div');
				imageContainer.className = 'category-detail-image';
				imageContainer.dataset.imageIndex = imgIndex;

				// Título
				const title = document.createElement('div');
				title.className = 'category-detail-image-title';
				title.textContent = imageData.title || 'Sin título';

				// Wrapper de la imagen
				const imageWrapper = document.createElement('div');
				imageWrapper.className = 'category-detail-image-wrapper';

				const img = document.createElement('img');
				if (typeof imageData === 'object' && imageData.src) {
					img.src = imageData.src.replace(/ /g, '%20');
				} else {
					img.src = imageData;
				}
				img.alt = imageData.title || categoryData.title;

				imageWrapper.appendChild(img);

				// Subtítulo
				const subtitle = document.createElement('div');
				subtitle.className = 'category-detail-image-subtitle';
				subtitle.textContent = imageData.subtitle || '';

				// Construir el contenedor
				imageContainer.appendChild(title);
				imageContainer.appendChild(imageWrapper);
				if (imageData.subtitle) {
					imageContainer.appendChild(subtitle);
				}

				// Click para abrir modal
				imageContainer.onclick = () => {
					modal.classList.add('active');
					modalImage.src = img.src;
					modalImage.removeAttribute('data-no-card-effect');
					document.body.style.overflow = 'hidden';
				};

				detailGrid.appendChild(imageContainer);

				// Animar solo en la primera entrada (Vista 2 → Vista 3)
				if (isFirstRender) {
					setTimeout(() => {
						imageContainer.classList.add('animate-in');
					}, imgIndex * 50);
				} else {
					// Sin animación al cambiar entre categorías
					imageContainer.style.opacity = '1';
					imageContainer.style.transform = 'translateY(0)';
				}
			});

			categoriesContainer.appendChild(detailHeader);
			categoriesContainer.appendChild(detailGrid);
		}

		function handleCardClick(e) {
			const card = e.currentTarget;
			const category = card.getAttribute('data-category');
			const color = categoryColors[category];
			const clickedWrapper = card.closest('.card-wrapper');

			console.log('Card clicked:', category);

			if (clickedWrapper.classList.contains('featured')) {
				modal.classList.add('active');
				const cardImage = clickedWrapper.querySelector('.card-front img');
				if (cardImage) {
					modalImage.src = cardImage.src;
					modalImage.removeAttribute('data-no-card-effect');
				}
				document.body.style.overflow = 'hidden';
				return;
			}

			const cardsContainer = document.getElementById('cardsContainer');
			const contentArea = document.getElementById('contentArea');
			const categoriesContainer = document.getElementById('categoriesContainer');
			const sectionTitleHeader = document.getElementById('sectionTitleHeader');

			console.log('Categories container found:', categoriesContainer);

			const previousFeatured = document.querySelector('.card-wrapper.featured');
			if (previousFeatured) {
				previousFeatured.classList.remove('featured');
				previousFeatured.classList.add('in-menu');
				const previousCardInner = previousFeatured.querySelector('.card-inner');
				if (previousCardInner) {
					previousCardInner.style.transform = 'rotateY(180deg)';
				}
			}

			clickedWrapper.classList.add('featured');
			clickedWrapper.classList.remove('in-menu');
			const clickedCardInner = clickedWrapper.querySelector('.card-inner');
			if (clickedCardInner) {
				clickedCardInner.style.transform = 'rotateY(0deg)';
			}

			const allCardWrappers = document.querySelectorAll('.card-wrapper');
			allCardWrappers.forEach(wrapper => {
				if (!wrapper.classList.contains('featured')) {
					wrapper.classList.add('in-menu');
					const cardInner = wrapper.querySelector('.card-inner');
					if (cardInner) {
						cardInner.style.transform = 'rotateY(180deg)';
					}
				}
			});

			cardsContainer.classList.add('compact');
			document.body.className = `${color}-theme`;
			currentTheme = `${color}-theme`;
			updateCardPositions();

			contentArea.style.display = 'none';
			contentArea.classList.remove('show');

			currentCategory = category;

			if (portfolioData[category]) {
				sectionTitleHeader.textContent = portfolioData[category].name;
			}

			console.log('Calling renderCategories for:', category);
			renderCategories(category);
		}

		function handleCardHover(e) {
			const card = e.currentTarget;
			const wrapper = card.closest('.card-wrapper');

			const rect = card.getBoundingClientRect();
			const x = e.clientX - rect.left;
			const y = e.clientY - rect.top;

			const centerX = rect.width / 2;
			const centerY = rect.height / 2;

			let rotateX, rotateY, rotateZ, scale;

			if (wrapper.classList.contains('featured')) {
				rotateX = ((y - centerY) / centerY) * -5;
				rotateY = ((x - centerX) / centerX) * 5;
				rotateZ = 0;
				scale = 1.02;
				card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(${scale})`;
			} else if (wrapper.classList.contains('in-menu')) {
				rotateX = ((y - centerY) / centerY) * -8;
				rotateY = ((x - centerX) / centerX) * 8;
				rotateZ = 180;
				scale = 1.05;
				card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY + rotateZ}deg) scale(${scale})`;
			} else {
				rotateX = ((y - centerY) / centerY) * -10;
				rotateY = ((x - centerX) / centerX) * 10;
				rotateZ = 0;
				scale = 1.05;
				card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(${scale})`;
			}
		}

		function handleCardEnter(e) {
			const card = e.currentTarget;
			card.style.transition = 'transform 0.15s ease-out';
		}

		function handleCardLeave(e) {
			const card = e.currentTarget;
			const wrapper = card.closest('.card-wrapper');
			card.style.transition = 'transform 0.6s ease-out';

			if (wrapper.classList.contains('in-menu')) {
				card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(180deg) scale(1)';
			} else {
				card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)';
			}
		}
	</script>
</body>

</html>
